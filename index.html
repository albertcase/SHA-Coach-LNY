<!DOCTYPE HTML>
<html>
<head>
    <title>2017“酉”鸿运！</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="format-detection" content="telephone=no">
    <!-- uc强制竖屏 -->
    <meta name="screen-orientation" content="landscape">
    <!-- QQ强制竖屏 -->
    <meta name="x5-orientation" content="landscape">

    <!--禁用手机号码链接(for iPhone)-->
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0,minimum-scale=1.0,maximum-scale=1.0,minimal-ui" />
    <!--自适应设备宽度-->
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!--控制全屏时顶部状态栏的外，默认白色-->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="Keywords" content="">
    <meta name="Description" content="...">
    <link rel="stylesheet" type="text/css" href="/dist/asset/css/all.min.css">
    <script type="text/javascript" src="/dist/asset/js/all.min.js"></script>
    <script type="text/javascript" src="http://coach.samesamechina.com/api/v1/js/9a6edd5b-c1bc-4d6a-9dd4-b03defc4ff46/wechat"></script>
    <style type="text/css">
        
        .IIV::-webkit-media-controls-play-button,
        .IIV::-webkit-media-controls-start-playback-button {
            opacity: 0;
            pointer-events: none;
            width: 5px;
        }

    </style>

    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?6cd44258dd7a23d93973055d942129ed";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
    </script>

</head>
<body>

<div class="loading">
    <div class="loading_con">
        <img src="/dist/asset/img/logo.png" width="100%">

        <div class="spinner">
            <div class="bounce1"></div>
            <div class="bounce2"></div>
            <div class="bounce3"></div>
        </div>
        <p>目前涌入的小伙伴过多<br>页面正在跳转中，请耐心等待。</p>
    </div>
</div>

<!-- 横屏代码 -->
<div id="orientLayer" class="mod-orient-layer">
    <div class="mod-orient-layer__content">
        <i class="icon mod-orient-layer__icon-orient"></i>
        <div class="mod-orient-layer__desc">请在解锁模式下，横屏体验游戏</div>
    </div>
</div>

<div id="dreambox">

    <!-- 首页 -->
    <div class="section" id="home">
        
        <div class="footer">
            <a href="javascript:;" class="btn challenge_btn">我要挑战</a>
            <p>
                <a href="javascript:;" class="rule">活动细则</a>
            </p>
        </div>
    </div>

    <!-- 活动视频 -->
    <div class="section" id="video">
        <video width="100%" height="0" id="lnyvideo" preload="auto" playsinline webkit-playsinline src="/dist/asset/media/lny.mp4" poster="/dist/asset/media/poster.jpg"></video>
    </div>


</div>



<div class="popup-rule transition hidden" id="rule-pop">
  <div class="p-model">
    <h4>活动细则 <i class="ruleclose"><img src="" sourcesrc="/dist/src/img/close.png" width="100%"></i></h4>
    <div class="p-model-con" id="pop-rule">
        <strong>本次活动最终解释权归蔻驰贸易（上海）有限公司所有。</strong><br>
        <ol type="1">
            <li>参与资格: 任何中国公民均有资格参与蔻驰微信“2017'酉'鸿运！”活动（以下简称本活动）。本次活动将严格遵守中华人民共和国的相关法律及法规。参与本活动表示你同意无条件完全遵守本活动细则以及活动主办方的相关决定。</li>
            <li>活动主办方: 蔻驰贸易（上海）有限公司 南京西路1717号会德丰广场20楼，200042.</li>
            <li>活动时间: 本活动日期由北京时间1月18日，活动主办方的电脑时间为本次活动的官方时间标准。</li>
            <li> 怎样参与本次活动:<br>
            在活动期间，所有添加蔻驰官方微信账号的用户，根据账号内指引在规定时间内完成任务，并关注Coach蔻驰官方微信，即有资格领取卡券。活动主办方有义务在活动期间保证活动功能可被正常使用。</li>
            <li>
            获奖者的认证：所有的活动参与者都必须满足活动细则中的所有条款。获取奖品的先决条件是必须完成所有相关的任务。主办方不会接受截图或者其他的证据来验证获奖资格。在活动期间，如果在系统出现问题时产生的结果是不会被视作有效的。活动主办方在法律允许范围内负责制定、解释、修改并及时公布本次活动的规则，并最终确定获奖者。
            </li>
            <li>奖品：由蔻驰提供的红包一份（数量有限，送完为止）。</li>
            <li>
            活动信息公告：在符合法律相关规定的情况下，获奖者必须同意活动主办方在媒体上披露获奖者的姓名，微信头像与信息，语音，意见，身份信息和居住城市，主办方并不需要为此再支付额外费用或另行通知。活动主办方有权依据相关法律法规或业务需要，中止或取消此次活动或者修改活动方案，经相关途径公告后生效。</li>
            <li>一般性条款：如果发现欺诈，或者技术事故，或者由超出活动主办方能力控制的影响活动公正性的情况发生，活动主办方保留单方面取消或者变更本活动的相关权利。如果发生类似情况，活动主办方保留随机发送奖品給予事故发生前活动参赛者的权利。活动主办方同时保留在参赛者违反公平性原则或者利用不当行为获利的情况下单方面取消参赛者资格的权利。活动主办方保留采取法律手段追诉对于蓄意破坏和攻击活动网站的人的权利并可能要求相关赔偿。</li>
            <li>
            豁免条款: 参与本次活动的参赛者不得采用任何直接或者间接的方式沟通或者伤害任何蔻驰贸易（上海）有限公司及其合作伙伴及和本次活动有关的任何相关公司的雇员。
            </li> 
            <li>
            相关责任: 活动主办方不对以下情况负责：<br>
                <ol type="1">
                     <li>由媒体提供的关于本次活动的任何不准确或者不精确的信息</li>
                     <li>任何形式的技术故障，包括软硬件的损坏或者网络问题</li>
                     <li>对于本次活动的人为的恶意破坏</li>
                     <li>技术或人为的监管问题</li>
                     <li>因为参加本次活动直接或间接而产生的人身伤害。</li>
                     <li>如果因为技术或者收到恶意攻击等原因导致实际获奖者总人数超过事先公布的人数，活动主办方保留从中按照事先公布的获奖总数从中随机抽取的权利。</li>
                     <li>由于技术问题包括但不仅限于微信软件系统问题而产生的现金红包无法使用的问题。</li>
                     <li>用户对于该金额的支配和使用而产生的相关问题。</li>
                </ol>
            </li>
        </ol>
        <br>

    </div>
  </div>
</div>






<script type="text/javascript" src="/dist/asset/js/public.min.js"></script>

<script type="text/javascript">

    var pType = pfun.getQueryString("delcookie");
    if(pType){
        pfun.delCookie("times")
    }

    var timesObj = {
        "_ts": pfun.getCookie("times"),        // 后端cookie设置 1/null   游戏失败   // 判断跳转成功或失败
        //"_sts": pfun.getCookie("shareTimes")   // 前端cookie设置 1/null   null可再次玩游戏
    }

    var allimg = [
        "/dist/asset/img/close.png",
        "/dist/asset/img/logo.png",
        "/dist/asset/img/p1.jpg",
        "/dist/asset/img/p2.jpg",
        "/dist/asset/img/p3.jpg",
        "/dist/asset/img/p4.jpg",

        "/dist/asset/media/poster.jpg",
        "/dist/asset/media/lny.mp4",
    ];

    if(timesObj["_ts"] != null || timesObj["_ts"] == 0){
        allimg = [
            "/dist/asset/img/logo.png",
            "/dist/asset/img/p1.jpg",
            "/dist/asset/img/p3.jpg",
            "/dist/asset/img/p4.jpg",
        ]
    };

    // console.log(allimg);

    pfun.loadingFnDoing(allimg, function(){
        $(".loading").css({"visibility": "hidden"});
        _lny.init();
    })

    function lnyFun(){
        var self = this;

        /* 公共函数 即 默认执行 */
        self.init = function(){   // 初始化执行函数
            self.sectionChange("home"); 
            pfun.init();
            $("#dreambox").css({"visibility": "visible"});

            pfun.overscroll(document.querySelector("#pop-rule"));  // 活动规则滚动条
        };

        this.creatMedia = function(_id, _url, _ap, _poster){    // 创建视频
            var video = '<video width="100%" height="100%" id="'+_id+'" preload="auto" playsinline webkit-playsinline src="'+_url+'" poster="'+_poster+'"></video>'
            return video;
        }

        // 视频事件监测
        self.eventTester = function(m, e, c){    // 视频事件监测函数
            /*
             * eventTester("play");              // play()和autoplay开始播放时触发
             * eventTester("pause");             // pause() 暂停触发
             * eventTester("timeupdate");        // 播放时间改变
             * eventTester("ended");             // 播放结束
             */
            m.addEventListener(e,function(){
                 c()
            },false);
        }

        // 页面切换
        self.sectionChange = function(n){        // section 页面切换

            if(n == "video"){
                self.videoFun();
            }

            $(".section").removeClass("show transition");
            $("#" + n).addClass('show transition');  
        }

        // 弹层
        self.lnyPrompt = function(node, status){
            if(status){
                $(".popup").removeClass("hidden");
                $("#" + node).removeClass("hidden").addClass("ycenter transition");
            }else{
                $(".popup").addClass("hidden");
                $(".popup .con").addClass("hidden").removeClass("ycenter transition");
            }
        }

        /* 事件函数 */
        self.videoFun = function(){
            var lnyvideo = document.getElementById("lnyvideo");
                //lnyvideo.play(); 
                lnyvideo
                lnyvideo.style.height = "103%";
                lnyvideo.style.margin = "-1% 0 0 0";

            self.eventTester(lnyvideo, "ended", function(){

                location.href = "/second";
                lnyvideo.pause(); 
                lnyvideo.style.height = "0";
                // setTimeout(function(){
                //     _lny.sectionChange("games");
                // }, 2000)
            });
        }



    }


    var _lny = new lnyFun();

    


    $(".challenge_btn").on("click", function(){
        if(timesObj["_ts"] == null || timesObj["_ts"] == 0 || timesObj["_ts"] == "1"){                              // 第一次进入游戏  /  分享之后得到次数

            if(timesObj["_ts"] == "1"){
                pfun.setCookie("times", "0", "360");
            };

            var videoHTML = _lny.creatMedia("lnyvideo", "/dist/asset/media/lny.mp4", false, "/dist/asset/media/poster.jpg");
            $("#video").html(videoHTML);
            var lnyvideo = document.getElementById("lnyvideo");
            lnyvideo.play(); 
            setTimeout(function(){
                _hmt.push(['_trackEvent', 'play', 'video', '视频播放次数']);
                _lny.sectionChange("video");
            }, 600);
        }else if(timesObj["_ts"] == "2"){                         //游戏失败
            location.href = "/third?type=failure";
        }else{                                                    // 游戏完成
            // location.href = "/third?type=yattention";
        };


        _hmt.push(['_trackEvent', 'click', 'btn', '我要挑战']);
    })

    // 活动规则点击事件
    $(".rule").on('touchstart', function(e){
        $("#rule-pop").removeClass("hidden").addClass("ycenter transition");

        _hmt.push(['_trackEvent', 'click', 'link', '活动规则']);
        e.preventDefault();
    })

    // 活动规则关闭事件
    $(".ruleclose").on('click', function(e){
        $("#rule-pop").addClass("hidden").removeClass("ycenter transition");
        e.preventDefault();
    })






// cookie 设置
// pfun.setCookie("coachIsShare", "1", "360");
// alert(pfun.getCookie("coachIsShare") + "set");
// pfun.delCookie("coachIsShare");
// console.log(pfun.getCookie("coachIsShare") + "del");

console.log(timesObj["_ts"]);


</script>



</body>
</html>